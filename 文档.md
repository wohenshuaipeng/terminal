1. 技术选型
桌面壳

Wails v2（Go 后端 + WebView 前端，跨平台打包轻量）

前端

Vue 3 + Vite

UI 组件：Naive UI 或 Element Plus（文件管理器好做）

终端：xterm.js（事实标准）

状态管理：Pinia

路由：Vue Router

后端（Go）

SSH：golang.org/x/crypto/ssh

SFTP：github.com/pkg/sftp

本地存储：SQLite（modernc.org/sqlite 纯 Go 或 github.com/mattn/go-sqlite3 依赖 CGO）

凭据存储（跨平台安全）：

macOS Keychain / Windows Credential Manager / Linux Secret Service

Go库：github.com/zalando/go-keyring（跨平台封装）

2. 总体架构（强烈建议这样分层）
[Vue UI]
  - 终端视图（xterm.js）
  - 文件管理器（树/列表/拖拽/右键）
  - 连接管理（主机列表、分组、标签）
  - 下载任务管理（队列、进度、取消）
        |
        | Wails Bindings / Events
        v
[Go App Layer]
  - Profiles（主机配置、分组）
  - Session Manager（SSH会话管理、复用、重连）
  - Terminal Gateway（PTY/交互流）
  - FileService（SFTP文件操作）
  - TransferService（下载上传、进度）
  - Keyring（密码/私钥口令）
  - HostKey（known_hosts 校验）
        |
        v
[SSH/SFTP]
  - Remote servers


核心思想：
终端用“流式通道”（事件/WS），文件操作用 RPC，下载上传用任务 + 事件推送。

3. 功能分解（MVP → 增强）
MVP（建议先做这 6 件）

主机配置：新增/编辑/删除（host, port, user, auth）

SSH 连接：连上、断开、错误提示

终端：可交互（xterm.js），支持 resize

文件浏览：ls/stat/cd、目录列表

下载：从远端下载到本地（带进度）

known_hosts：首次连接提示指纹，允许/拒绝并保存

增强（后续迭代）

上传、拖拽上传

多会话、多 Tab、会话保持/重连

搜索/收藏/最近连接

端口转发、跳板机、ProxyCommand

远端文件预览（文本/图片）

权限/所有者展示、chmod/chown

命令面板（常用脚本一键执行）

4. 项目目录结构（推荐）
ssh-manager/
  frontend/                # Vue3 + Vite
    src/
      app/
      pages/
      components/
      stores/
      services/            # 调后端 API 封装
      terminal/            # xterm.js 封装
      files/               # 文件管理 UI/逻辑
  backend/
    cmd/
    internal/
      app/                 # Wails 绑定入口（对前端暴露方法）
      profiles/            # 主机配置 CRUD
      session/             # SSH会话、连接池、重连
      terminal/            # interactive shell：stdin/stdout/resize
      sftp/                # 文件操作
      transfer/            # 下载上传任务、进度事件
      security/
        keyring/           # 凭据存储
        hostkey/           # known_hosts + 指纹校验
      storage/             # sqlite/repo
      common/              # utils、errors、context、logger
  wails.json
  README.md

5. 前后端通信设计（你照这个做就顺）
5.1 Wails RPC：用于“请求-响应”类

适合：

获取主机列表

连接/断开

文件列表

创建下载任务（返回 taskId）

5.2 Wails Events：用于“流式/进度/实时输出”

适合：

终端输出流（stdout）

下载/上传进度推送

连接状态变化（connected/disconnected/reconnecting）

6. 核心 API 设计（前端调用的 Go 方法）

下面这些是你 MVP 必须的接口，接口名可以直接用。

6.1 Profiles（主机配置）

Profiles.List() -> []Profile

Profiles.Save(profile) -> profileId

Profiles.Delete(profileId)

Profile 建议结构：

{
  "id": "uuid",
  "name": "prod-1",
  "group": "Production",
  "host": "1.2.3.4",
  "port": 22,
  "username": "root",
  "authType": "password|privateKey",
  "privateKeyPath": "~/.ssh/id_ed25519",
  "useKeyring": true,
  "knownHostsPolicy": "ask|strict|accept-new"
}

6.2 Session（连接与会话）

Session.Connect(profileId) -> sessionId

Session.Disconnect(sessionId)

Session.Status(sessionId) -> {state, lastError}

连接流程要做：

hostkey 校验（首次提示指纹）

使用 keyring 拿密码/口令（不落库）

6.3 Terminal（交互式 shell）

强烈建议：一个 session 可以有多个 terminal tab（不同 channel）

Terminal.Open(sessionId) -> termId

Terminal.Write(termId, data) // 用户输入

Terminal.Resize(termId, cols, rows)

Terminal.Close(termId)

事件：

terminal:data {termId, chunk} // 后端推给前端

terminal:exit {termId, code}

实现要点：

用 ssh.NewSession() + RequestPty() + Shell()

把 session.Stdout/Stderr 合并流式推送

6.4 SFTP（文件浏览）

Files.List(sessionId, path) -> []FileEntry

Files.Stat(sessionId, path) -> FileEntry

Files.Mkdir(sessionId, path)

Files.Remove(sessionId, path, recursive)

Files.Rename(sessionId, from, to)

FileEntry 示例：

{
  "name":"logs",
  "path":"/var/log",
  "isDir":true,
  "size":4096,
  "mode":"drwxr-xr-x",
  "mtime":1700000000
}

6.5 Transfer（下载/上传任务）

Transfer.Download(sessionId, remotePath, localPath) -> taskId

Transfer.Upload(sessionId, localPath, remotePath) -> taskId

Transfer.Cancel(taskId)

Transfer.ListTasks() -> []Task

事件：

transfer:progress {taskId, doneBytes, totalBytes, speedBytes, state}

transfer:done {taskId}

transfer:error {taskId, message}

实现要点：

任务队列（最大并发 2~4）

大文件分块读写，定时上报进度（例如 200ms）

取消：context cancel + 关闭 reader/writer

7. 关键工程细节（决定你能不能“像成品”）
7.1 known_hosts 策略（必须做，不然不安全）

三种模式：

ask：首次连接弹窗确认指纹（推荐默认）

strict：必须已存在才允许连接（企业常用）

accept-new：新主机自动加入 known_hosts（方便但风险更高）

存储位置建议：

App 自己维护：~/.ssh-manager/known_hosts

7.2 凭据存储（必须用 keyring）

数据库只存 profile，不存明文密码：

密码/私钥口令存到系统 keychain

Profile 里只存一个 key 名称（如 cred:<profileId>）

7.3 会话复用与重连（增强但很值）

一个 profileId 对应一个连接（client）

多个 terminal / sftp 共用同一 client

KeepAlive：每 30s send request

断线：标记 disconnected，UI 提示并允许重连

8. 前端页面设计（Vue）
页面结构

Connections（左侧列表 + 搜索 + 分组）

Workspace（右侧主区域 Tab）

Tab：Terminal / Files / Transfers

Host Editor（弹窗表单）

Host Key Prompt（首次连接指纹确认）

终端实现（xterm.js）

一个 termId 对应一个 xterm 实例

用户输入：Terminal.Write(termId, data)

后端输出：监听 terminal:data 事件 append 到 xterm

文件管理器

左侧目录树（可选）

右侧列表（虚拟滚动）

双击进入目录

右键：下载/上传/重命名/删除

9. 开发顺序（照这个做最快出成果）
第 1 周：能连上 + 能敲命令

Profiles CRUD（先用内存或 sqlite）

Connect/Disconnect

Terminal.Open/Write/Resize + xterm.js

known_hosts “ask”弹窗

第 2 周：文件浏览 + 下载

SFTP List/Stat

Download + Transfer progress 事件

任务列表 UI

第 3 周：上传 + 打磨

Upload（支持拖拽）

错误处理、重连、并发限制

打包 mac/win/linux

10. 你开工需要的“最小命令清单”（我给你路线，不让你踩坑）
初始化（你来做项目时用）

wails init -n ssh-manager -t vue（Wails 提供 Vue 模板）

pnpm i 或 npm i

wails dev（开发模式联调）

wails build（跨平台构建，分别在对应平台构建最好）

11. 我还差你 4 个产品决策，决定很多实现细节（你不用懂，直接选）

你直接回复选项即可：

认证方式 MVP 支持哪些？

A. 密码 + 私钥

B. 只私钥

C. 密码/私钥/跳板机（后续）

是否需要 多 Tab（多个终端/多个服务器同时开）？

A. 必须

B. 后续再做

文件下载保存位置：

A. 用户选择保存路径

B. 统一下载到 ~/Downloads/ssh-manager/

是否要支持 跳板机（bastion）？

A. 需要

B. 暂时不需要

如果你回复这 4 个选择，我就能把这份设计进一步“落到代码级别”——给你：

关键 Go 接口与结构体草图（SessionManager/TerminalHub/TransferQueue）

前端 Vue 的页面组件拆分与事件订阅示例

以及你 MVP 第一周的具体任务清单（按天拆）